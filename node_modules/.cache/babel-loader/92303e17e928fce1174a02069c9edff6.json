{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Alex/Documents/react-person/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/Alex/Documents/react-person/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/Alex/Documents/react-person/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/Alex/Documents/react-person/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Alex/Documents/react-person/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Alex/Documents/react-person/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useState,useEffect}from'react';import'./PersonList.css';import $ from\"jquery\";import Scrollbars from'react-custom-scrollbars';import{makeStyles}from'@material-ui/core/styles';import List from'@material-ui/core/List';import ListItem from'@material-ui/core/ListItem';import ListItemSecondaryAction from'@material-ui/core/ListItemSecondaryAction';import ListItemText from'@material-ui/core/ListItemText';import IconButton from'@material-ui/core/IconButton';import Grid from'@material-ui/core/Grid';import Typography from'@material-ui/core/Typography';import CloseIcon from'@material-ui/icons/Close';import SendIcon from'@material-ui/icons/Send';import EditIcon from'@material-ui/icons/Edit';import{putFormDataAsJson,deletePerson,getAllPersonSorteredByColumn}from'../../api/PersonAPI';import{convertFormDataToObject}from'../../utils/FormData';import{getListOfFilteredID}from'../../utils/ListFilter';import Button from'@material-ui/core/Button';import FilterListIcon from'@material-ui/icons/FilterList';// Initialisation des valeurs de filtres\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var initialFilteredPersonList={id:'',firstname:'',lastname:'',address:'',isActive:''};var initialSortPersonList={id:false,firstname:false,lastname:false,address:false,isActive:false};export default function PersonList(_ref){var setPersonList=_ref.setPersonList,personList=_ref.personList;var classes=useStyles();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),editedRowIndex=_useState2[0],setEditedRowIndex=_useState2[1];var _useState3=useState(initialFilteredPersonList),_useState4=_slicedToArray(_useState3,2),filterOptions=_useState4[0],setFilterOptions=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),filteredListPerson=_useState6[0],setFilteredListPerson=_useState6[1];var _useState7=useState(initialSortPersonList),_useState8=_slicedToArray(_useState7,2),sortColumnsStatus=_useState8[0],setSortColumnsStatus=_useState8[1];var _useState9=useState(\"id\"),_useState10=_slicedToArray(_useState9,2),actualColumnSorted=_useState10[0],setActualColumnSorted=_useState10[1];// Gestion du state stockant les valeurs de filtrage\nvar handleFormFilterInput=function handleFormFilterInput(e){var _e$target=e.target,value=_e$target.value,name=_e$target.name;setFilterOptions(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},name,value));});};// permet de switcher sur le mode édition d'une ligne\nvar toggleIsEditing=function toggleIsEditing(e){if($(e.currentTarget).attr('class').includes('editableIcon')){var personID=$($(e.currentTarget).parents()[3]).find('.personID').text();var editableIndex=filteredListPerson.findIndex(function(item){return parseInt(item.id)===parseInt(personID);});setEditedRowIndex(editableIndex);}};// Element React pour la modification d'une ligne\nvar EditableRow=function EditableRow(_ref2){var value=_ref2.value,name=_ref2.name,type=_ref2.type,lastRow=_ref2.lastRow;return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",width:lastRow?'70%':'100%'},children:/*#__PURE__*/_jsx(\"input\",{className:\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline\",defaultValue:value,name:name,type:type,style:{border:'#008080 solid 0.5px',width:'100%',margin:'2px'}})})});};// Gérer le formulaire de la mise à jour d'une personne\nvar handleFormSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var personID,updateIndex,url,_convertFormDataToObj,formData,_,responseData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();// Récupérer les données du formulaire\npersonID=$(e.currentTarget).find('.personID').find('input').attr('value');updateIndex=filteredListPerson.findIndex(function(item){return parseInt(item.id)===parseInt(personID);});url=\"person/\".concat(personID);_context.prev=4;// Requête PUT\n_convertFormDataToObj=convertFormDataToObject(e),formData=_convertFormDataToObj.formData,_=_convertFormDataToObj._;_context.next=8;return putFormDataAsJson({formData:formData,url:url});case 8:responseData=_context.sent;// Mise à jour de la liste des utilisateurs\nsetPersonList(function(prevState){return[].concat(_toConsumableArray(prevState.slice(0,updateIndex)),[responseData],_toConsumableArray(prevState.slice(updateIndex+1)));});setEditedRowIndex(-1);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](4);console.error(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[4,13]]);}));return function handleFormSubmit(_x){return _ref3.apply(this,arguments);};}();var sortColumn=function sortColumn(col){setSortColumnsStatus(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},col,!sortColumnsStatus[col]));});console.log(col);setActualColumnSorted(col);$('.columnFilter').val(\"\");};// Initialisation du state stockant la liste filtrée\nuseEffect(function(){setFilteredListPerson(personList);},[personList]);// Appel à l'algorithme à chaque fois qu'une valeur de filtrage change\nuseEffect(function(){var filteredID=getListOfFilteredID(filterOptions,personList);if(filteredID.length!=0){setFilteredListPerson(personList.filter(function(item,index){return filteredID.includes(String(item.id));}));}},[filterOptions]);useEffect(function(){if(sortColumnsStatus[actualColumnSorted]){console.log(actualColumnSorted);console.log(sortColumnsStatus[actualColumnSorted]);console.log('true');getAllPersonSorteredByColumn(actualColumnSorted,\"desc\").then(function(data){setFilteredListPerson(data);});}else{console.log('false');getAllPersonSorteredByColumn(actualColumnSorted,\"asc\").then(function(data){setFilteredListPerson(data);});}},[actualColumnSorted,sortColumnsStatus]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Scrollbars,{style:{width:'70%',height:'100%'},renderTrackHorizontal:function renderTrackHorizontal(props){return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({},props),{},{style:{display:'none'},className:\"track-horizontal\"}));},children:/*#__PURE__*/_jsx(Grid,{item:true,xs:16,md:12,children:/*#__PURE__*/_jsxs(List,{className:classes.List,children:[/*#__PURE__*/_jsxs(ListItem,{className:classes.listItem,style:{backgroundColor:'#9AC2C980'},children:[/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Button,{type:\"body2\",style:{fontWeight:700,width:10,color:'#004040'},onClick:function onClick(){return sortColumn(\"id\");},endIcon:/*#__PURE__*/_jsx(FilterListIcon,{}),children:\"ID\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Button,{type:\"body2\",style:{fontWeight:700,width:10,color:'#004040'},onClick:function onClick(){return sortColumn(\"firstname\");},endIcon:/*#__PURE__*/_jsx(FilterListIcon,{}),children:\"Pr\\xE9nom\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Button,{type:\"body2\",style:{fontWeight:700,width:10,color:'#004040'},onClick:function onClick(){return sortColumn(\"lastname\");},endIcon:/*#__PURE__*/_jsx(FilterListIcon,{}),children:\"Nom\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Button,{type:\"body2\",style:{fontWeight:700,width:10,color:'#004040'},onClick:function onClick(){return sortColumn(\"address\");},endIcon:/*#__PURE__*/_jsx(FilterListIcon,{}),children:\"Adresse\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Button,{type:\"body2\",style:{fontWeight:700,width:10,color:'#004040',paddingRight:30},onClick:function onClick(){return sortColumn(\"isActive\");},endIcon:/*#__PURE__*/_jsx(FilterListIcon,{}),children:\"Actif\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"delete\",type:\"submit\",children:/*#__PURE__*/_jsx(SendIcon,{style:{display:\"none\"}})})}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"delete\",type:\"submit\",children:/*#__PURE__*/_jsx(SendIcon,{style:{display:\"none\"}})})})]}),/*#__PURE__*/_jsx(\"form\",{className:\"filterForm\",children:/*#__PURE__*/_jsxs(ListItem,{className:classes.listItem,children:[/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",width:'100%'},children:/*#__PURE__*/_jsx(\"input\",{className:\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\",defaultValue:filterOptions[\"id\"],onChange:handleFormFilterInput,name:\"id\",style:{border:'#008080 solid 0.5px',width:'100%',margin:'2px'},placeholder:\"Filtrer\"})}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",width:'100%'},children:/*#__PURE__*/_jsx(\"input\",{className:\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\",defaultValue:filterOptions[\"firstname\"],onChange:handleFormFilterInput,name:\"firstname\",style:{border:'#008080 solid 0.5px',width:'100%',margin:'2px'},placeholder:\"Filtrer\"})}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",width:'100%'},children:/*#__PURE__*/_jsx(\"input\",{className:\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\",defaultValue:filterOptions[\"lastname\"],onChange:handleFormFilterInput,name:\"lastname\",style:{border:'#008080 solid 0.5px',width:'100%',margin:'2px'},placeholder:\"Filtrer\"})}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",width:'100%'},children:/*#__PURE__*/_jsx(\"input\",{className:\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\",defaultValue:filterOptions[\"address\"],onChange:handleFormFilterInput,name:\"address\",style:{border:'#008080 solid 0.5px',width:'100%',margin:'2px'},placeholder:\"Filtrer\"})}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",width:'70%'},children:/*#__PURE__*/_jsx(\"input\",{className:\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\",defaultValue:filterOptions[\"isActive\"],onChange:handleFormFilterInput,name:\"isActive\",style:{border:'#008080 solid 0.5px',width:'100%',margin:'2px'},placeholder:\"Filtrer\"})}),className:classes.listItemText})]})}),filteredListPerson.map(function(item,index){return index===editedRowIndex?/*#__PURE__*/_jsx(\"form\",{className:\"editForm\",onSubmit:handleFormSubmit,children:/*#__PURE__*/_jsxs(ListItem,{className:classes.listItem,children:[/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(EditableRow,{value:item.id,name:\"id\"}),className:\"\".concat(classes.listItemText,\" personID\")}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(EditableRow,{value:item.firstname,name:\"firstname\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(EditableRow,{value:item.lastname,name:\"lastname\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(EditableRow,{value:item.address,name:\"address\",type:\"email\"}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(EditableRow,{value:item.isActive,name:\"isActive\",lastRow:true}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"edit\",type:\"submit\",children:/*#__PURE__*/_jsx(SendIcon,{style:{fill:\"#008080\"}})})})]})}):/*#__PURE__*/_jsxs(ListItem,{className:classes.listItem,children:[/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Typography,{type:\"body2\",children:item.id}),className:\"\".concat(classes.listItemText,\" personID\")}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Typography,{type:\"body2\",children:item.firstname}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Typography,{type:\"body2\",children:item.lastname}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Typography,{type:\"body2\",children:item.address}),className:classes.listItemText}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(Typography,{type:\"body2\",children:parseInt(item.isActive)?'1':'0'}),className:classes.listItemText}),/*#__PURE__*/_jsxs(ListItemSecondaryAction,{children:[/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"edit\",children:/*#__PURE__*/_jsx(EditIcon,{style:{fill:\"#008080\"},onClick:toggleIsEditing,className:\"editableIcon\"})}),/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"delete\",children:/*#__PURE__*/_jsx(CloseIcon,{style:{fill:\"#008080\"},onClick:function onClick(e){e.preventDefault();e.stopPropagation();var personID=$($(e.currentTarget).parents()[3]).find('.personID').text();deletePerson(personID).then(function(){// Récuperer l'index de l'élément à supprimer\nvar removeIndex=filteredListPerson.findIndex(function(item){return item.id===parseInt(personID);});// Faire une copie du state\nvar newArray=_toConsumableArray(filteredListPerson);// Supprimer l'élément du nouveau tableau\nnewArray.splice(removeIndex,1);// Mettre à jour le state\nsetFilteredListPerson(newArray);});}})})]})]});})]})})})});}var useStyles=makeStyles(function(theme){var _buttonText;return{listItem:{backgroundColor:'none',\"&:hover\":{backgroundColor:'rgba(0,0,0,0.05);',cursor:'pointer'},padding:4},listItemText:{display:'flex',justifyContent:'flex-start','&:nth-child(1)':{width:'10%',justifyContent:'center'},'&:nth-child(2)':{width:'20%'},'&:nth-child(3)':{width:'20%'},'&:nth-child(4)':{width:'30%'},'&:nth-child(5)':{width:'20%'}},button:_defineProperty({margin:theme.spacing(1)},theme.breakpoints.down(\"sm\"),{minWidth:32,paddingLeft:8,paddingRight:8,marginBottom:40,cursor:\"pointer\",\"& .MuiButton-startIcon\":{margin:0}}),buttonText:(_buttonText={},_defineProperty(_buttonText,theme.breakpoints.down(\"sm\"),{display:\"none\"}),_defineProperty(_buttonText,\"display\",\"flex\"),_defineProperty(_buttonText,\"marginRight\",5),_buttonText),List:{padding:0},Input:{'&:nth-child(5)':{width:'70%'}}};});","map":{"version":3,"sources":["C:/Users/Alex/Documents/react-person/src/components/PersonList/PersonList.js"],"names":["React","useState","useEffect","$","Scrollbars","makeStyles","List","ListItem","ListItemSecondaryAction","ListItemText","IconButton","Grid","Typography","CloseIcon","SendIcon","EditIcon","putFormDataAsJson","deletePerson","getAllPersonSorteredByColumn","convertFormDataToObject","getListOfFilteredID","Button","FilterListIcon","initialFilteredPersonList","id","firstname","lastname","address","isActive","initialSortPersonList","PersonList","setPersonList","personList","classes","useStyles","editedRowIndex","setEditedRowIndex","filterOptions","setFilterOptions","filteredListPerson","setFilteredListPerson","sortColumnsStatus","setSortColumnsStatus","actualColumnSorted","setActualColumnSorted","handleFormFilterInput","e","target","value","name","prevState","toggleIsEditing","currentTarget","attr","includes","personID","parents","find","text","editableIndex","findIndex","item","parseInt","EditableRow","type","lastRow","display","justifyContent","width","border","margin","handleFormSubmit","preventDefault","updateIndex","url","formData","_","responseData","slice","console","error","sortColumn","col","log","val","filteredID","length","filter","index","String","then","data","height","props","listItem","backgroundColor","fontWeight","color","listItemText","paddingRight","map","fill","stopPropagation","removeIndex","newArray","splice","theme","cursor","padding","button","spacing","breakpoints","down","minWidth","paddingLeft","marginBottom","buttonText","Input"],"mappings":"w6BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAO,kBAAP,CACA,MAAOC,CAAAA,CAAP,KAAc,QAAd,CACA,MAAOC,CAAAA,UAAP,KAAuB,yBAAvB,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,QAAP,KAAqB,4BAArB,CACA,MAAOC,CAAAA,uBAAP,KAAoC,2CAApC,CACA,MAAOC,CAAAA,YAAP,KAAyB,gCAAzB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CACA,MAAOC,CAAAA,IAAP,KAAiB,wBAAjB,CACA,MAAOC,CAAAA,UAAP,KAAuB,8BAAvB,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,QAAP,KAAqB,yBAArB,CACA,MAAOC,CAAAA,QAAP,KAAqB,yBAArB,CACA,OAASC,iBAAT,CAA4BC,YAA5B,CAA0CC,4BAA1C,KAA8E,qBAA9E,CACA,OAASC,uBAAT,KAAwC,sBAAxC,CACA,OAASC,mBAAT,KAAoC,wBAApC,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,cAAP,KAA2B,+BAA3B,CAGA;6IACA,GAAMC,CAAAA,yBAAyB,CAAG,CAC9BC,EAAE,CAAE,EAD0B,CAE9BC,SAAS,CAAE,EAFmB,CAG9BC,QAAQ,CAAE,EAHoB,CAI9BC,OAAO,CAAE,EAJqB,CAK9BC,QAAQ,CAAE,EALoB,CAAlC,CAQA,GAAMC,CAAAA,qBAAqB,CAAG,CAC1BL,EAAE,CAAE,KADsB,CAE1BC,SAAS,CAAE,KAFe,CAG1BC,QAAQ,CAAE,KAHgB,CAI1BC,OAAO,CAAE,KAJiB,CAK1BC,QAAQ,CAAE,KALgB,CAA9B,CAQA,cAAe,SAASE,CAAAA,UAAT,MAAmD,IAA7BC,CAAAA,aAA6B,MAA7BA,aAA6B,CAAdC,UAAc,MAAdA,UAAc,CAC9D,GAAMC,CAAAA,OAAO,CAAGC,SAAS,EAAzB,CACA,cAA4CjC,QAAQ,CAAC,IAAD,CAApD,wCAAOkC,cAAP,eAAuBC,iBAAvB,eACA,eAA2CnC,QAAQ,CAACsB,yBAAD,CAAnD,yCAAOc,aAAP,eAAsBC,gBAAtB,eACA,eAAoDrC,QAAQ,CAAC,EAAD,CAA5D,yCAAOsC,kBAAP,eAA2BC,qBAA3B,eACA,eAAkDvC,QAAQ,CAAC4B,qBAAD,CAA1D,yCAAOY,iBAAP,eAA0BC,oBAA1B,eACA,eAAoDzC,QAAQ,CAAC,IAAD,CAA5D,0CAAO0C,kBAAP,gBAA2BC,qBAA3B,gBAEA;AACA,GAAMC,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,CAACC,CAAD,CAAO,CACjC,cAAwBA,CAAC,CAACC,MAA1B,CAAQC,KAAR,WAAQA,KAAR,CAAeC,IAAf,WAAeA,IAAf,CACAX,gBAAgB,CAAC,SAAAY,SAAS,CAAI,CAC1B,sCAAWA,SAAX,wBAAuBD,IAAvB,CAA8BD,KAA9B,GACH,CAFe,CAAhB,CAGH,CALD,CAOA;AACA,GAAMG,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACL,CAAD,CAAO,CAC3B,GAAI3C,CAAC,CAAC2C,CAAC,CAACM,aAAH,CAAD,CAAmBC,IAAnB,CAAwB,OAAxB,EAAiCC,QAAjC,CAA0C,cAA1C,CAAJ,CAA+D,CAC3D,GAAMC,CAAAA,QAAQ,CAAGpD,CAAC,CAACA,CAAC,CAAC2C,CAAC,CAACM,aAAH,CAAD,CAAmBI,OAAnB,GAA6B,CAA7B,CAAD,CAAD,CAAmCC,IAAnC,CAAwC,WAAxC,EAAqDC,IAArD,EAAjB,CACA,GAAMC,CAAAA,aAAa,CAAGpB,kBAAkB,CAACqB,SAAnB,CAA6B,SAAAC,IAAI,QAAIC,CAAAA,QAAQ,CAACD,IAAI,CAACrC,EAAN,CAAR,GAAsBsC,QAAQ,CAACP,QAAD,CAAlC,EAAjC,CAAtB,CACAnB,iBAAiB,CAACuB,aAAD,CAAjB,CACH,CACJ,CAND,CAQA;AACA,GAAMI,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,OAAoC,IAAjCf,CAAAA,KAAiC,OAAjCA,KAAiC,CAA1BC,IAA0B,OAA1BA,IAA0B,CAApBe,IAAoB,OAApBA,IAAoB,CAAdC,OAAc,OAAdA,OAAc,CACpD,mBACI,KAAC,KAAD,CAAO,QAAP,wBACA,YAAK,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,YAAnC,CAAiDC,KAAK,CAAEH,OAAO,CAAG,KAAH,CAAW,MAA1E,CAAZ,uBACI,cACI,SAAS,kEADb,CAEI,YAAY,CAAEjB,KAFlB,CAGI,IAAI,CAAEC,IAHV,CAII,IAAI,CAAEe,IAJV,CAKI,KAAK,CAAE,CAACK,MAAM,CAAE,qBAAT,CAAgCD,KAAK,CAAE,MAAvC,CAA+CE,MAAM,CAAE,KAAvD,CALX,EADJ,EADA,EADJ,CAaH,CAdD,CAgBA;AACA,GAAMC,CAAAA,gBAAgB,2FAAG,iBAAOzB,CAAP,6LACrBA,CAAC,CAAC0B,cAAF,GAEA;AACMjB,QAJe,CAIJpD,CAAC,CAAC2C,CAAC,CAACM,aAAH,CAAD,CAAmBK,IAAnB,CAAwB,WAAxB,EAAqCA,IAArC,CAA0C,OAA1C,EAAmDJ,IAAnD,CAAwD,OAAxD,CAJI,CAKfoB,WALe,CAKDlC,kBAAkB,CAACqB,SAAnB,CAA6B,SAAAC,IAAI,QAAIC,CAAAA,QAAQ,CAACD,IAAI,CAACrC,EAAN,CAAR,GAAsBsC,QAAQ,CAACP,QAAD,CAAlC,EAAjC,CALC,CAMfmB,GANe,kBAMCnB,QAND,kBASjB;AATiB,sBAUMpC,uBAAuB,CAAC2B,CAAD,CAV7B,CAUT6B,QAVS,uBAUTA,QAVS,CAUCC,CAVD,uBAUCA,CAVD,uBAWQ5D,CAAAA,iBAAiB,CAAC,CAAE2D,QAAQ,CAARA,QAAF,CAAYD,GAAG,CAAHA,GAAZ,CAAD,CAXzB,QAWbG,YAXa,eAajB;AACA9C,aAAa,CAAC,SAAAmB,SAAS,CAAI,CACvB,mCAAYA,SAAS,CAAC4B,KAAV,CAAgB,CAAhB,CAAmBL,WAAnB,CAAZ,GAA6CI,YAA7C,qBAA8D3B,SAAS,CAAC4B,KAAV,CAAgBL,WAAW,CAAG,CAA9B,CAA9D,GACH,CAFY,CAAb,CAIArC,iBAAiB,CAAC,CAAC,CAAF,CAAjB,CAlBiB,iFAoBjB2C,OAAO,CAACC,KAAR,cApBiB,qEAAH,kBAAhBT,CAAAA,gBAAgB,6CAAtB,CAwBA,GAAMU,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,GAAD,CAAS,CACxBxC,oBAAoB,CAAC,SAAAQ,SAAS,CAAI,CAC9B,sCAAWA,SAAX,wBAAuBgC,GAAvB,CAA6B,CAACzC,iBAAiB,CAACyC,GAAD,CAA/C,GACH,CAFmB,CAApB,CAGAH,OAAO,CAACI,GAAR,CAAYD,GAAZ,EACAtC,qBAAqB,CAACsC,GAAD,CAArB,CACA/E,CAAC,CAAC,eAAD,CAAD,CAAmBiF,GAAnB,CAAuB,EAAvB,EACH,CAPD,CASA;AACAlF,SAAS,CAAC,UAAM,CACZsC,qBAAqB,CAACR,UAAD,CAArB,CACH,CAFQ,CAEN,CAACA,UAAD,CAFM,CAAT,CAIA;AACA9B,SAAS,CAAC,UAAM,CACZ,GAAMmF,CAAAA,UAAU,CAAGjE,mBAAmB,CAACiB,aAAD,CAAgBL,UAAhB,CAAtC,CACA,GAAIqD,UAAU,CAACC,MAAX,EAAqB,CAAzB,CAA4B,CACxB9C,qBAAqB,CAACR,UAAU,CAACuD,MAAX,CAAkB,SAAC1B,IAAD,CAAO2B,KAAP,QAAiBH,CAAAA,UAAU,CAAC/B,QAAX,CAAoBmC,MAAM,CAAC5B,IAAI,CAACrC,EAAN,CAA1B,CAAjB,EAAlB,CAAD,CAArB,CACH,CACJ,CALQ,CAKN,CAACa,aAAD,CALM,CAAT,CAOAnC,SAAS,CAAC,UAAM,CACZ,GAAIuC,iBAAiB,CAACE,kBAAD,CAArB,CAA2C,CACvCoC,OAAO,CAACI,GAAR,CAAYxC,kBAAZ,EACAoC,OAAO,CAACI,GAAR,CAAY1C,iBAAiB,CAACE,kBAAD,CAA7B,EACAoC,OAAO,CAACI,GAAR,CAAY,MAAZ,EACAjE,4BAA4B,CAACyB,kBAAD,CAAqB,MAArB,CAA5B,CAAyD+C,IAAzD,CAA8D,SAAAC,IAAI,CAAI,CAClEnD,qBAAqB,CAACmD,IAAD,CAArB,CACH,CAFD,EAGH,CAPD,IAOO,CACHZ,OAAO,CAACI,GAAR,CAAY,OAAZ,EACAjE,4BAA4B,CAACyB,kBAAD,CAAqB,KAArB,CAA5B,CAAwD+C,IAAxD,CAA6D,SAAAC,IAAI,CAAI,CACjEnD,qBAAqB,CAACmD,IAAD,CAArB,CACH,CAFD,EAGH,CACJ,CAdQ,CAcN,CAAChD,kBAAD,CAAqBF,iBAArB,CAdM,CAAT,CAiBA,mBACI,sCACA,KAAC,UAAD,EAAY,KAAK,CAAE,CAAE2B,KAAK,CAAE,KAAT,CAAgBwB,MAAM,CAAE,MAAxB,CAAnB,CAAqD,qBAAqB,CAAE,+BAAAC,KAAK,qBAAI,0CAASA,KAAT,MAAgB,KAAK,CAAE,CAAC3B,OAAO,CAAE,MAAV,CAAvB,CAA0C,SAAS,CAAC,kBAApD,GAAJ,EAAjF,uBACE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,CAAmB,EAAE,CAAE,EAAvB,uBACI,MAAC,IAAD,EAAM,SAAS,CAAEjC,OAAO,CAAC3B,IAAzB,wBACM,MAAC,QAAD,EAAU,SAAS,CAAE2B,OAAO,CAAC6D,QAA7B,CAAuC,KAAK,CAAE,CAAEC,eAAe,CAAE,WAAnB,CAA9C,wBACI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,MAAD,EAAQ,IAAI,CAAC,OAAb,CAAqB,KAAK,CAAE,CAAEC,UAAU,CAAE,GAAd,CAAmB5B,KAAK,CAAE,EAA1B,CAA8B6B,KAAK,CAAE,SAArC,CAA5B,CAA8E,OAAO,CAAE,yBAAMhB,CAAAA,UAAU,CAAC,IAAD,CAAhB,EAAvF,CAA+G,OAAO,cAAE,KAAC,cAAD,IAAxH,gBAFb,CAGI,SAAS,CAAEhD,OAAO,CAACiE,YAHvB,EADJ,cAMI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,MAAD,EAAQ,IAAI,CAAC,OAAb,CAAqB,KAAK,CAAE,CAAEF,UAAU,CAAE,GAAd,CAAmB5B,KAAK,CAAE,EAA1B,CAA8B6B,KAAK,CAAE,SAArC,CAA5B,CAA8E,OAAO,CAAE,yBAAMhB,CAAAA,UAAU,CAAC,WAAD,CAAhB,EAAvF,CAAsH,OAAO,cAAE,KAAC,cAAD,IAA/H,uBAFb,CAGI,SAAS,CAAEhD,OAAO,CAACiE,YAHvB,EANJ,cAWI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,MAAD,EAAQ,IAAI,CAAC,OAAb,CAAqB,KAAK,CAAE,CAAEF,UAAU,CAAE,GAAd,CAAmB5B,KAAK,CAAE,EAA1B,CAA8B6B,KAAK,CAAE,SAArC,CAA5B,CAA8E,OAAO,CAAE,yBAAMhB,CAAAA,UAAU,CAAC,UAAD,CAAhB,EAAvF,CAAqH,OAAO,cAAE,KAAC,cAAD,IAA9H,iBAFb,CAGI,SAAS,CAAEhD,OAAO,CAACiE,YAHvB,EAXJ,cAgBI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,MAAD,EAAQ,IAAI,CAAC,OAAb,CAAqB,KAAK,CAAE,CAAEF,UAAU,CAAE,GAAd,CAAmB5B,KAAK,CAAE,EAA1B,CAA8B6B,KAAK,CAAE,SAArC,CAA5B,CAA8E,OAAO,CAAE,yBAAMhB,CAAAA,UAAU,CAAC,SAAD,CAAhB,EAAvF,CAAoH,OAAO,cAAE,KAAC,cAAD,IAA7H,qBAFb,CAGI,SAAS,CAAEhD,OAAO,CAACiE,YAHvB,EAhBJ,cAqBI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,MAAD,EAAQ,IAAI,CAAC,OAAb,CAAqB,KAAK,CAAE,CAAEF,UAAU,CAAE,GAAd,CAAmB5B,KAAK,CAAE,EAA1B,CAA8B6B,KAAK,CAAE,SAArC,CAAgDE,YAAY,CAAE,EAA9D,CAA5B,CAAgG,OAAO,CAAE,yBAAMlB,CAAAA,UAAU,CAAC,UAAD,CAAhB,EAAzG,CAAuI,OAAO,cAAE,KAAC,cAAD,IAAhJ,mBAFb,CAGI,SAAS,CAAEhD,OAAO,CAACiE,YAHvB,EArBJ,cA0BI,KAAC,uBAAD,wBACI,KAAC,UAAD,EAAY,IAAI,CAAC,KAAjB,CAAuB,aAAW,QAAlC,CAA2C,IAAI,CAAC,QAAhD,uBACI,KAAC,QAAD,EACI,KAAK,CAAE,CAAChC,OAAO,CAAE,MAAV,CADX,EADJ,EADJ,EA1BJ,cAiCI,KAAC,uBAAD,wBACI,KAAC,UAAD,EAAY,IAAI,CAAC,KAAjB,CAAuB,aAAW,QAAlC,CAA2C,IAAI,CAAC,QAAhD,uBACI,KAAC,QAAD,EACI,KAAK,CAAE,CAACA,OAAO,CAAE,MAAV,CADX,EADJ,EADJ,EAjCJ,GADN,cA0CM,aAAM,SAAS,CAAC,YAAhB,uBACI,MAAC,QAAD,EAAU,SAAS,CAAEjC,OAAO,CAAC6D,QAA7B,wBACI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cACP,YAAK,KAAK,CAAE,CAAE5B,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,YAAnC,CAAiDC,KAAK,CAAE,MAAxD,CAAZ,uBACI,cACI,SAAS,CAAC,8EADd,CAEI,YAAY,CAAE/B,aAAa,CAAC,IAAD,CAF/B,CAGI,QAAQ,CAAEQ,qBAHd,CAII,IAAI,CAAE,IAJV,CAKI,KAAK,CAAE,CAACwB,MAAM,CAAE,qBAAT,CAAgCD,KAAK,CAAE,MAAvC,CAA+CE,MAAM,CAAE,KAAvD,CALX,CAMI,WAAW,CAAC,SANhB,EADJ,EAHJ,CAaI,SAAS,CAAErC,OAAO,CAACiE,YAbvB,EADJ,cAgBI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cACP,YAAK,KAAK,CAAE,CAAEhC,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,YAAnC,CAAiDC,KAAK,CAAE,MAAxD,CAAZ,uBACI,cACI,SAAS,CAAC,8EADd,CAEI,YAAY,CAAE/B,aAAa,CAAC,WAAD,CAF/B,CAGI,QAAQ,CAAEQ,qBAHd,CAII,IAAI,CAAE,WAJV,CAKI,KAAK,CAAE,CAACwB,MAAM,CAAE,qBAAT,CAAgCD,KAAK,CAAE,MAAvC,CAA+CE,MAAM,CAAE,KAAvD,CALX,CAMI,WAAW,CAAC,SANhB,EADJ,EAHJ,CAaI,SAAS,CAAErC,OAAO,CAACiE,YAbvB,EAhBJ,cA+BI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cACP,YAAK,KAAK,CAAE,CAAEhC,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,YAAnC,CAAiDC,KAAK,CAAE,MAAxD,CAAZ,uBACI,cACI,SAAS,CAAC,8EADd,CAEI,YAAY,CAAE/B,aAAa,CAAC,UAAD,CAF/B,CAGI,QAAQ,CAAEQ,qBAHd,CAII,IAAI,CAAE,UAJV,CAKI,KAAK,CAAE,CAACwB,MAAM,CAAE,qBAAT,CAAgCD,KAAK,CAAE,MAAvC,CAA+CE,MAAM,CAAE,KAAvD,CALX,CAMI,WAAW,CAAC,SANhB,EADJ,EAHJ,CAaI,SAAS,CAAErC,OAAO,CAACiE,YAbvB,EA/BJ,cA8CI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cACP,YAAK,KAAK,CAAE,CAAEhC,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,YAAnC,CAAiDC,KAAK,CAAE,MAAxD,CAAZ,uBACI,cACI,SAAS,CAAC,8EADd,CAEI,YAAY,CAAE/B,aAAa,CAAC,SAAD,CAF/B,CAGI,QAAQ,CAAEQ,qBAHd,CAII,IAAI,CAAE,SAJV,CAKI,KAAK,CAAE,CAACwB,MAAM,CAAE,qBAAT,CAAgCD,KAAK,CAAE,MAAvC,CAA+CE,MAAM,CAAE,KAAvD,CALX,CAMI,WAAW,CAAC,SANhB,EADJ,EAHJ,CAaI,SAAS,CAAErC,OAAO,CAACiE,YAbvB,EA9CJ,cA6DI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cACP,YAAK,KAAK,CAAE,CAAEhC,OAAO,CAAE,MAAX,CAAmBC,cAAc,CAAE,YAAnC,CAAiDC,KAAK,CAAE,KAAxD,CAAZ,uBACI,cACI,SAAS,CAAC,8EADd,CAEI,YAAY,CAAE/B,aAAa,CAAC,UAAD,CAF/B,CAGI,QAAQ,CAAEQ,qBAHd,CAII,IAAI,CAAE,UAJV,CAKI,KAAK,CAAE,CAACwB,MAAM,CAAE,qBAAT,CAAgCD,KAAK,CAAE,MAAvC,CAA+CE,MAAM,CAAE,KAAvD,CALX,CAMI,WAAW,CAAC,SANhB,EADJ,EAHJ,CAaI,SAAS,CAAErC,OAAO,CAACiE,YAbvB,EA7DJ,GADJ,EA1CN,CAyHG3D,kBAAkB,CAAC6D,GAAnB,CAAuB,SAACvC,IAAD,CAAO2B,KAAP,QACpBA,CAAAA,KAAK,GAAKrD,cAAV,cACI,aAAM,SAAS,CAAC,UAAhB,CAA2B,QAAQ,CAAEoC,gBAArC,uBACI,MAAC,QAAD,EAAU,SAAS,CAAEtC,OAAO,CAAC6D,QAA7B,wBACI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,WAAD,EAAa,KAAK,CAAEjC,IAAI,CAACrC,EAAzB,CAA6B,IAAI,CAAE,IAAnC,EAFb,CAGI,SAAS,WAAKS,OAAO,CAACiE,YAAb,aAHb,EADJ,cAMI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,WAAD,EAAa,KAAK,CAAErC,IAAI,CAACpC,SAAzB,CAAoC,IAAI,CAAE,WAA1C,EAFb,CAGI,SAAS,CAAEQ,OAAO,CAACiE,YAHvB,EANJ,cAWI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,WAAD,EAAa,KAAK,CAAErC,IAAI,CAACnC,QAAzB,CAAmC,IAAI,CAAE,UAAzC,EAFb,CAGI,SAAS,CAAEO,OAAO,CAACiE,YAHvB,EAXJ,cAgBI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,WAAD,EAAa,KAAK,CAAErC,IAAI,CAAClC,OAAzB,CAAkC,IAAI,CAAE,SAAxC,CAAmD,IAAI,CAAE,OAAzD,EAFb,CAGI,SAAS,CAAEM,OAAO,CAACiE,YAHvB,EAhBJ,cAqBI,KAAC,YAAD,EACI,iBAAiB,KADrB,CAEI,OAAO,cAAE,KAAC,WAAD,EAAa,KAAK,CAAErC,IAAI,CAACjC,QAAzB,CAAmC,IAAI,CAAE,UAAzC,CAAqD,OAAO,CAAE,IAA9D,EAFb,CAGI,SAAS,CAAEK,OAAO,CAACiE,YAHvB,EArBJ,cA0BI,KAAC,uBAAD,wBACI,KAAC,UAAD,EAAY,IAAI,CAAC,KAAjB,CAAuB,aAAW,MAAlC,CAAyC,IAAI,CAAC,QAA9C,uBACI,KAAC,QAAD,EACI,KAAK,CAAE,CAACG,IAAI,CAAE,SAAP,CADX,EADJ,EADJ,EA1BJ,GADJ,EADJ,cAsCA,MAAC,QAAD,EAAU,SAAS,CAAEpE,OAAO,CAAC6D,QAA7B,wBACQ,KAAC,YAAD,EACA,iBAAiB,KADjB,CAEA,OAAO,cAAE,KAAC,UAAD,EAAY,IAAI,CAAC,OAAjB,UAA0BjC,IAAI,CAACrC,EAA/B,EAFT,CAGA,SAAS,WAAKS,OAAO,CAACiE,YAAb,aAHT,EADR,cAMQ,KAAC,YAAD,EACA,iBAAiB,KADjB,CAEA,OAAO,cAAE,KAAC,UAAD,EAAY,IAAI,CAAC,OAAjB,UAA2BrC,IAAI,CAACpC,SAAhC,EAFT,CAGA,SAAS,CAAEQ,OAAO,CAACiE,YAHnB,EANR,cAWQ,KAAC,YAAD,EACA,iBAAiB,KADjB,CAEA,OAAO,cAAE,KAAC,UAAD,EAAY,IAAI,CAAC,OAAjB,UAA0BrC,IAAI,CAACnC,QAA/B,EAFT,CAGA,SAAS,CAAEO,OAAO,CAACiE,YAHnB,EAXR,cAgBQ,KAAC,YAAD,EACA,iBAAiB,KADjB,CAEA,OAAO,cAAE,KAAC,UAAD,EAAY,IAAI,CAAC,OAAjB,UAA0BrC,IAAI,CAAClC,OAA/B,EAFT,CAGA,SAAS,CAAEM,OAAO,CAACiE,YAHnB,EAhBR,cAqBQ,KAAC,YAAD,EACA,iBAAiB,KADjB,CAEA,OAAO,cAAE,KAAC,UAAD,EAAY,IAAI,CAAC,OAAjB,UAA0BpC,QAAQ,CAACD,IAAI,CAACjC,QAAN,CAAR,CAA0B,GAA1B,CAAgC,GAA1D,EAFT,CAGA,SAAS,CAAEK,OAAO,CAACiE,YAHnB,EArBR,cA0BI,MAAC,uBAAD,yBACA,KAAC,UAAD,EAAY,IAAI,CAAC,KAAjB,CAAuB,aAAW,MAAlC,uBACI,KAAC,QAAD,EACI,KAAK,CAAE,CAACG,IAAI,CAAE,SAAP,CADX,CAEI,OAAO,CAAElD,eAFb,CAGI,SAAS,CAAC,cAHd,EADJ,EADA,cAQA,KAAC,UAAD,EAAY,IAAI,CAAC,KAAjB,CAAuB,aAAW,QAAlC,uBACI,KAAC,SAAD,EACI,KAAK,CAAE,CAACkD,IAAI,CAAE,SAAP,CADX,CAEI,OAAO,CAAE,iBAACvD,CAAD,CAAO,CACZA,CAAC,CAAC0B,cAAF,GACA1B,CAAC,CAACwD,eAAF,GACA,GAAM/C,CAAAA,QAAQ,CAAGpD,CAAC,CAACA,CAAC,CAAC2C,CAAC,CAACM,aAAH,CAAD,CAAmBI,OAAnB,GAA6B,CAA7B,CAAD,CAAD,CAAmCC,IAAnC,CAAwC,WAAxC,EAAqDC,IAArD,EAAjB,CACAzC,YAAY,CAACsC,QAAD,CAAZ,CAAuBmC,IAAvB,CAA4B,UAAM,CAC9B;AACA,GAAMa,CAAAA,WAAW,CAAGhE,kBAAkB,CAACqB,SAAnB,CAA6B,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACrC,EAAL,GAAYsC,QAAQ,CAACP,QAAD,CAAxB,EAAjC,CAApB,CAEA;AACA,GAAMiD,CAAAA,QAAQ,oBAAOjE,kBAAP,CAAd,CAEA;AACAiE,QAAQ,CAACC,MAAT,CAAgBF,WAAhB,CAA6B,CAA7B,EAEA;AACA/D,qBAAqB,CAACgE,QAAD,CAArB,CACH,CAZD,EAaH,CAnBL,EADJ,EARA,GA1BJ,GAvCoB,EAAvB,CAzHH,GADJ,EADF,EADA,EADJ,CAsOH,CAED,GAAMtE,CAAAA,SAAS,CAAG7B,UAAU,CAAC,SAACqG,KAAD,wBAAY,CACrCZ,QAAQ,CAAE,CACRC,eAAe,CAAE,MADT,CAER,UAAW,CACPA,eAAe,CAAE,mBADV,CAEPY,MAAM,CAAE,SAFD,CAFH,CAMRC,OAAO,CAAE,CAND,CAD2B,CASrCV,YAAY,CAAE,CACVhC,OAAO,CAAE,MADC,CAEVC,cAAc,CAAE,YAFN,CAGV,iBAAkB,CACdC,KAAK,CAAE,KADO,CAEdD,cAAc,CAAE,QAFF,CAHR,CAOV,iBAAkB,CACdC,KAAK,CAAE,KADO,CAPR,CAUV,iBAAkB,CACdA,KAAK,CAAE,KADO,CAVR,CAaV,iBAAkB,CACdA,KAAK,CAAE,KADO,CAbR,CAgBV,iBAAkB,CACdA,KAAK,CAAE,KADO,CAhBR,CATuB,CA6BrCyC,MAAM,kBACJvC,MAAM,CAAEoC,KAAK,CAACI,OAAN,CAAc,CAAd,CADJ,EAEHJ,KAAK,CAACK,WAAN,CAAkBC,IAAlB,CAAuB,IAAvB,CAFG,CAE4B,CAC9BC,QAAQ,CAAE,EADoB,CAE9BC,WAAW,CAAE,CAFiB,CAG9Bf,YAAY,CAAE,CAHgB,CAI9BgB,YAAY,CAAE,EAJgB,CAK9BR,MAAM,CAAE,SALsB,CAM9B,yBAA0B,CACxBrC,MAAM,CAAE,CADgB,CANI,CAF5B,CA7B+B,CA0CrC8C,UAAU,6CACPV,KAAK,CAACK,WAAN,CAAkBC,IAAlB,CAAuB,IAAvB,CADO,CACwB,CAC9B9C,OAAO,CAAE,MADqB,CADxB,wCAIC,MAJD,4CAKK,CALL,cA1C2B,CAiDrC5D,IAAI,CAAE,CACFsG,OAAO,CAAE,CADP,CAjD+B,CAoDrCS,KAAK,CAAE,CACH,iBAAkB,CACdjD,KAAK,CAAE,KADO,CADf,CApD8B,CAAZ,EAAD,CAA5B","sourcesContent":["import React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport './PersonList.css';\r\nimport $ from \"jquery\";\r\nimport Scrollbars from 'react-custom-scrollbars';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport { putFormDataAsJson, deletePerson, getAllPersonSorteredByColumn } from '../../api/PersonAPI';\r\nimport { convertFormDataToObject } from '../../utils/FormData';\r\nimport { getListOfFilteredID } from '../../utils/ListFilter';\r\nimport Button from '@material-ui/core/Button';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\n\r\n\r\n// Initialisation des valeurs de filtres\r\nconst initialFilteredPersonList = {\r\n    id: '',\r\n    firstname: '',\r\n    lastname: '',\r\n    address: '',\r\n    isActive: ''\r\n}\r\n\r\nconst initialSortPersonList = {\r\n    id: false,\r\n    firstname: false,\r\n    lastname: false,\r\n    address: false,\r\n    isActive: false\r\n}\r\n\r\nexport default function PersonList({ setPersonList, personList }) {\r\n    const classes = useStyles();\r\n    const [editedRowIndex, setEditedRowIndex] = useState(null);\r\n    const [filterOptions, setFilterOptions]  = useState(initialFilteredPersonList);\r\n    const [filteredListPerson, setFilteredListPerson] = useState([]);\r\n    const [sortColumnsStatus, setSortColumnsStatus] = useState(initialSortPersonList);\r\n    const [actualColumnSorted, setActualColumnSorted] = useState(\"id\");\r\n\r\n    // Gestion du state stockant les valeurs de filtrage\r\n    const handleFormFilterInput = (e) => {\r\n        const { value, name } = e.target;\r\n        setFilterOptions(prevState => {\r\n            return {...prevState, [name]: value}\r\n        });\r\n    }\r\n\r\n    // permet de switcher sur le mode édition d'une ligne\r\n    const toggleIsEditing = (e) => {\r\n        if ($(e.currentTarget).attr('class').includes('editableIcon')) {\r\n            const personID = $($(e.currentTarget).parents()[3]).find('.personID').text();\r\n            const editableIndex = filteredListPerson.findIndex(item => parseInt(item.id) === parseInt(personID));\r\n            setEditedRowIndex(editableIndex);\r\n        }\r\n    }   \r\n\r\n    // Element React pour la modification d'une ligne\r\n    const EditableRow = ({ value, name, type, lastRow }) => {\r\n        return (\r\n            <React.Fragment>\r\n            <div style={{ display: \"flex\", justifyContent: \"flex-start\", width: lastRow ? '70%' : '100%' }}>\r\n                <input\r\n                    className={`MuiTypography-root MuiTypography-h7 MuiTypography-displayInline`}\r\n                    defaultValue={value}\r\n                    name={name}\r\n                    type={type}\r\n                    style={{border: '#008080 solid 0.5px', width: '100%', margin: '2px'}}\r\n                />\r\n            </div>\r\n            </React.Fragment>\r\n        )\r\n    };\r\n\r\n    // Gérer le formulaire de la mise à jour d'une personne\r\n    const handleFormSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        // Récupérer les données du formulaire\r\n        const personID = $(e.currentTarget).find('.personID').find('input').attr('value');\r\n        const updateIndex = filteredListPerson.findIndex(item => parseInt(item.id) === parseInt(personID));\r\n        const url = `person/${personID}`;\r\n\r\n        try {\r\n            // Requête PUT\r\n            const { formData, _} = convertFormDataToObject(e);\r\n            let responseData = await putFormDataAsJson({ formData, url });\r\n\r\n            // Mise à jour de la liste des utilisateurs\r\n            setPersonList(prevState => {\r\n                return  [...prevState.slice(0, updateIndex), responseData, ...prevState.slice(updateIndex + 1)];\r\n            });\r\n\r\n            setEditedRowIndex(-1);\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    }\r\n\r\n    const sortColumn = (col) => {\r\n        setSortColumnsStatus(prevState => {\r\n            return {...prevState, [col]: !sortColumnsStatus[col]}\r\n        });\r\n        console.log(col);\r\n        setActualColumnSorted(col);\r\n        $('.columnFilter').val(\"\");\r\n    }\r\n\r\n    // Initialisation du state stockant la liste filtrée\r\n    useEffect(() => {\r\n        setFilteredListPerson(personList);\r\n    }, [personList]);\r\n\r\n    // Appel à l'algorithme à chaque fois qu'une valeur de filtrage change\r\n    useEffect(() => {\r\n        const filteredID = getListOfFilteredID(filterOptions, personList);\r\n        if (filteredID.length != 0) {\r\n            setFilteredListPerson(personList.filter((item, index) => filteredID.includes(String(item.id))));\r\n        }\r\n    }, [filterOptions]);\r\n\r\n    useEffect(() => {\r\n        if (sortColumnsStatus[actualColumnSorted]) {\r\n            console.log(actualColumnSorted);\r\n            console.log(sortColumnsStatus[actualColumnSorted]);\r\n            console.log('true');\r\n            getAllPersonSorteredByColumn(actualColumnSorted, \"desc\").then(data => {\r\n                setFilteredListPerson(data);\r\n            }); \r\n        } else {\r\n            console.log('false');\r\n            getAllPersonSorteredByColumn(actualColumnSorted, \"asc\").then(data => {\r\n                setFilteredListPerson(data);\r\n            }); \r\n        }\r\n    }, [actualColumnSorted, sortColumnsStatus]);\r\n\r\n\r\n    return (\r\n        <>\r\n        <Scrollbars style={{ width: '70%', height: '100%' }} renderTrackHorizontal={props => <div {...props} style={{display: 'none'}} className=\"track-horizontal\"/>}>\r\n          <Grid item xs={16} md={12}>\r\n              <List className={classes.List}>\r\n                    <ListItem className={classes.listItem} style={{ backgroundColor: '#9AC2C980' }}>\r\n                        <ListItemText\r\n                            disableTypography\r\n                            primary={<Button type=\"body2\" style={{ fontWeight: 700, width: 10, color: '#004040' }} onClick={() => sortColumn(\"id\")} endIcon={<FilterListIcon />}>ID</Button>}\r\n                            className={classes.listItemText}\r\n                        />\r\n                        <ListItemText\r\n                            disableTypography\r\n                            primary={<Button type=\"body2\" style={{ fontWeight: 700, width: 10, color: '#004040' }} onClick={() => sortColumn(\"firstname\")} endIcon={<FilterListIcon />}>Prénom</Button>}\r\n                            className={classes.listItemText}\r\n                        />\r\n                        <ListItemText\r\n                            disableTypography\r\n                            primary={<Button type=\"body2\" style={{ fontWeight: 700, width: 10, color: '#004040' }} onClick={() => sortColumn(\"lastname\")} endIcon={<FilterListIcon />}>Nom</Button>}\r\n                            className={classes.listItemText}\r\n                        />\r\n                        <ListItemText\r\n                            disableTypography\r\n                            primary={<Button type=\"body2\" style={{ fontWeight: 700, width: 10, color: '#004040' }} onClick={() => sortColumn(\"address\")} endIcon={<FilterListIcon />}>Adresse</Button>}\r\n                            className={classes.listItemText}\r\n                        />\r\n                        <ListItemText\r\n                            disableTypography\r\n                            primary={<Button type=\"body2\" style={{ fontWeight: 700, width: 10, color: '#004040', paddingRight: 30 }} onClick={() => sortColumn(\"isActive\")} endIcon={<FilterListIcon />}>Actif</Button>}\r\n                            className={classes.listItemText}\r\n                        />\r\n                        <ListItemSecondaryAction>\r\n                            <IconButton edge=\"end\" aria-label=\"delete\" type=\"submit\">\r\n                                <SendIcon \r\n                                    style={{display: \"none\"}} \r\n                                />\r\n                            </IconButton>\r\n                        </ListItemSecondaryAction>\r\n                        <ListItemSecondaryAction>\r\n                            <IconButton edge=\"end\" aria-label=\"delete\" type=\"submit\">\r\n                                <SendIcon \r\n                                    style={{display: \"none\"}} \r\n                                />\r\n                            </IconButton>\r\n                        </ListItemSecondaryAction>\r\n                    </ListItem>\r\n                    <form className=\"filterForm\">\r\n                        <ListItem className={classes.listItem}>\r\n                            <ListItemText\r\n                                disableTypography\r\n                                primary={\r\n                                <div style={{ display: \"flex\", justifyContent: \"flex-start\", width: '100%' }}>\r\n                                    <input\r\n                                        className=\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\"\r\n                                        defaultValue={filterOptions[\"id\"]}\r\n                                        onChange={handleFormFilterInput}\r\n                                        name={\"id\"}\r\n                                        style={{border: '#008080 solid 0.5px', width: '100%', margin: '2px'}}\r\n                                        placeholder=\"Filtrer\"\r\n                                    />\r\n                                </div>}\r\n                                className={classes.listItemText} \r\n                            />\r\n                            <ListItemText\r\n                                disableTypography\r\n                                primary={\r\n                                <div style={{ display: \"flex\", justifyContent: \"flex-start\", width: '100%' }}>\r\n                                    <input\r\n                                        className=\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\"\r\n                                        defaultValue={filterOptions[\"firstname\"]}\r\n                                        onChange={handleFormFilterInput}\r\n                                        name={\"firstname\"}\r\n                                        style={{border: '#008080 solid 0.5px', width: '100%', margin: '2px'}}\r\n                                        placeholder=\"Filtrer\"\r\n                                    />\r\n                                </div>}\r\n                                className={classes.listItemText}\r\n                            />\r\n                            <ListItemText\r\n                                disableTypography\r\n                                primary={\r\n                                <div style={{ display: \"flex\", justifyContent: \"flex-start\", width: '100%' }}>\r\n                                    <input\r\n                                        className=\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\"\r\n                                        defaultValue={filterOptions[\"lastname\"]}\r\n                                        onChange={handleFormFilterInput}\r\n                                        name={\"lastname\"}\r\n                                        style={{border: '#008080 solid 0.5px', width: '100%', margin: '2px'}}\r\n                                        placeholder=\"Filtrer\"\r\n                                    />\r\n                                </div>}\r\n                                className={classes.listItemText}\r\n                            />\r\n                            <ListItemText\r\n                                disableTypography\r\n                                primary={\r\n                                <div style={{ display: \"flex\", justifyContent: \"flex-start\", width: '100%' }}>\r\n                                    <input\r\n                                        className=\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\"\r\n                                        defaultValue={filterOptions[\"address\"]}\r\n                                        onChange={handleFormFilterInput}\r\n                                        name={\"address\"}\r\n                                        style={{border: '#008080 solid 0.5px', width: '100%', margin: '2px'}}\r\n                                        placeholder=\"Filtrer\"    \r\n                                    />\r\n                                </div>}\r\n                                className={classes.listItemText}\r\n                            />\r\n                            <ListItemText\r\n                                disableTypography\r\n                                primary={\r\n                                <div style={{ display: \"flex\", justifyContent: \"flex-start\", width: '70%' }}>\r\n                                    <input\r\n                                        className=\"MuiTypography-root MuiTypography-h7 MuiTypography-displayInline columnFilter\"\r\n                                        defaultValue={filterOptions[\"isActive\"]}\r\n                                        onChange={handleFormFilterInput}\r\n                                        name={\"isActive\"}\r\n                                        style={{border: '#008080 solid 0.5px', width: '100%', margin: '2px'}}\r\n                                        placeholder=\"Filtrer\"\r\n                                    />\r\n                                </div>}\r\n                                className={classes.listItemText}\r\n                            />\r\n                        </ListItem>\r\n                    </form>\r\n                {filteredListPerson.map((item, index) => (\r\n                    index === editedRowIndex ? ( \r\n                        <form className=\"editForm\" onSubmit={handleFormSubmit}>\r\n                            <ListItem className={classes.listItem}>\r\n                                <ListItemText\r\n                                    disableTypography\r\n                                    primary={<EditableRow value={item.id} name={\"id\"}/>}\r\n                                    className={`${classes.listItemText} personID`}\r\n                                />\r\n                                <ListItemText\r\n                                    disableTypography\r\n                                    primary={<EditableRow value={item.firstname} name={\"firstname\"} />}\r\n                                    className={classes.listItemText}\r\n                                />\r\n                                <ListItemText\r\n                                    disableTypography\r\n                                    primary={<EditableRow value={item.lastname} name={\"lastname\"} />}\r\n                                    className={classes.listItemText}\r\n                                />\r\n                                <ListItemText\r\n                                    disableTypography\r\n                                    primary={<EditableRow value={item.address} name={\"address\"} type={\"email\"}/>}\r\n                                    className={classes.listItemText}\r\n                                />\r\n                                <ListItemText\r\n                                    disableTypography\r\n                                    primary={<EditableRow value={item.isActive} name={\"isActive\"} lastRow={true} />}\r\n                                    className={classes.listItemText}\r\n                                />\r\n                                <ListItemSecondaryAction>\r\n                                    <IconButton edge=\"end\" aria-label=\"edit\" type=\"submit\">\r\n                                        <SendIcon \r\n                                            style={{fill: \"#008080\"}} \r\n                                        />\r\n                                    </IconButton>\r\n                                </ListItemSecondaryAction>\r\n                            </ListItem>\r\n                       </form>\r\n                        ) : (\r\n                    <ListItem className={classes.listItem}>\r\n                            <ListItemText\r\n                            disableTypography\r\n                            primary={<Typography type=\"body2\">{item.id}</Typography>}\r\n                            className={`${classes.listItemText} personID`}\r\n                            />\r\n                            <ListItemText\r\n                            disableTypography\r\n                            primary={<Typography type=\"body2\" >{item.firstname}</Typography>}\r\n                            className={classes.listItemText}\r\n                            />\r\n                            <ListItemText\r\n                            disableTypography\r\n                            primary={<Typography type=\"body2\">{item.lastname}</Typography>}\r\n                            className={classes.listItemText}\r\n                            />\r\n                            <ListItemText\r\n                            disableTypography\r\n                            primary={<Typography type=\"body2\">{item.address}</Typography>}\r\n                            className={classes.listItemText}\r\n                            />\r\n                            <ListItemText\r\n                            disableTypography\r\n                            primary={<Typography type=\"body2\">{parseInt(item.isActive) ? '1' : '0'}</Typography>}\r\n                            className={classes.listItemText}\r\n                            />\r\n                        <ListItemSecondaryAction>\r\n                        <IconButton edge=\"end\" aria-label=\"edit\">\r\n                            <EditIcon \r\n                                style={{fill: \"#008080\"}} \r\n                                onClick={toggleIsEditing}\r\n                                className=\"editableIcon\" \r\n                            />\r\n                        </IconButton>\r\n                        <IconButton edge=\"end\" aria-label=\"delete\">\r\n                            <CloseIcon \r\n                                style={{fill: \"#008080\"}} \r\n                                onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    e.stopPropagation();\r\n                                    const personID = $($(e.currentTarget).parents()[3]).find('.personID').text();\r\n                                    deletePerson(personID).then(() => {\r\n                                        // Récuperer l'index de l'élément à supprimer\r\n                                        const removeIndex = filteredListPerson.findIndex(item => item.id === parseInt(personID));\r\n                                    \r\n                                        // Faire une copie du state\r\n                                        const newArray = [...filteredListPerson];\r\n                                    \r\n                                        // Supprimer l'élément du nouveau tableau\r\n                                        newArray.splice(removeIndex, 1);\r\n                                    \r\n                                        // Mettre à jour le state\r\n                                        setFilteredListPerson(newArray);\r\n                                    });\r\n                                }} \r\n                            />\r\n                        </IconButton>\r\n                        </ListItemSecondaryAction>\r\n                    </ListItem>\r\n                    )\r\n                ))}\r\n              </List>\r\n          </Grid>\r\n        </Scrollbars>\r\n        </>\r\n    )\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    listItem: {\r\n      backgroundColor: 'none',\r\n      \"&:hover\": {\r\n          backgroundColor: 'rgba(0,0,0,0.05);',\r\n          cursor: 'pointer'\r\n      },\r\n      padding: 4,\r\n    },\r\n    listItemText: {\r\n        display: 'flex',\r\n        justifyContent: 'flex-start',\r\n        '&:nth-child(1)': {\r\n            width: '10%',\r\n            justifyContent: 'center',\r\n        },\r\n        '&:nth-child(2)': {\r\n            width: '20%'\r\n        },\r\n        '&:nth-child(3)': {\r\n            width: '20%'\r\n        },\r\n        '&:nth-child(4)': {\r\n            width: '30%'\r\n        },\r\n        '&:nth-child(5)': {\r\n            width: '20%',\r\n        }\r\n    },\r\n    button: {\r\n      margin: theme.spacing(1),\r\n      [theme.breakpoints.down(\"sm\")]: {\r\n        minWidth: 32,\r\n        paddingLeft: 8,\r\n        paddingRight: 8,\r\n        marginBottom: 40,\r\n        cursor: \"pointer\",\r\n        \"& .MuiButton-startIcon\": {\r\n          margin: 0\r\n        }\r\n      }\r\n    },\r\n    buttonText: {\r\n      [theme.breakpoints.down(\"sm\")]: {\r\n        display: \"none\"\r\n      },\r\n      display: \"flex\",\r\n      marginRight: 5\r\n    },\r\n    List: {\r\n        padding: 0,\r\n    },\r\n    Input: {\r\n        '&:nth-child(5)': {\r\n            width: '70%'\r\n        }\r\n    }\r\n}));"]},"metadata":{},"sourceType":"module"}